{"title":"V2Ray安装教程（初阶）","date":"2020-07-04T12:56:00.000Z","date_formatted":{"ll":"2020年7月4日","L":"2020/07/04","MM-DD":"07-04"},"author":"Nanzet","link":"2020/07/04/V2Ray安装教程（初阶）","tags":["v2ray"],"categories":["技术"],"updated":"2022-11-19T15:43:12.598Z","content":"<blockquote>\n<p><strong>【声明：仅供学习交流、查阅资料使用，后果自负】</strong></p>\n</blockquote>\n<h4 id=\"一、购买vps\">一、购买VPS<a title=\"#一、购买vps\" href=\"#一、购买vps\"></a></h4>\n<p>注：已弃用virmach不稳定，购买了Hostus $16/年的套餐，可以修改系统为ubuntu下面的安装v2ray等步骤一样。</p>\n<h5 id=\"1.1-购买说明\">1.1 购买说明<a title=\"#1.1-购买说明\" href=\"#1.1-购买说明\"></a></h5>\n<p> 我购买的是：<a href=\"https://billing.virmach.com/\" target=\"_blank\">virmach</a>–&gt;register–&gt;<a href=\"https://billing.virmach.com/cart.php?gid=18\" target=\"_blank\">KVM &amp; SSD Windows VPS</a>（季付，可搜索virmach优惠码进行兑换；注意操作系统建议选择ubuntu 16.04.6，初始选择的centos 6.5安装v2ray失败）</p>\n<p><img src=\"https://raw.githubusercontent.com/Nanzet/nanzet-imgs/master/images/2020062401.jpg\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p> 上述vps ping的时候不是特别稳定，不过配置v2ray后，速度还可以，能满足查阅资料的需求（这款流量用不完，可以按照自己需求选购套餐）；其他vps推荐：<a href=\"http://www.hostusvps.com/\" target=\"_blank\">HostUs</a>购买以下套餐即可：（已购买速度快很多、更稳定）</p>\n<p><img src=\"https://raw.githubusercontent.com/Nanzet/nanzet-imgs/master/images/2020062402.jpg\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<h4 id=\"二、ubuntu-16.04.6-安装服务端v2ray流程\">二、ubuntu 16.04.6 安装服务端v2ray流程<a title=\"#二、ubuntu-16.04.6-安装服务端v2ray流程\" href=\"#二、ubuntu-16.04.6-安装服务端v2ray流程\"></a></h4>\n<blockquote>\n<p>注：<br>\n 使用xshell可远程连接vps，根据hostus提供的root账户密码、IP进行登录连接；初始登录可使用passwd命令更改root账户密码，以后使用该密码即可；若忘记自己设置的密码，在hostus购买的的vps管理界面更改root密码即可。</p>\n</blockquote>\n<h5 id=\"2.1-更新apt\">2.1 更新apt<a title=\"#2.1-更新apt\" href=\"#2.1-更新apt\"></a></h5>\n<pre><code>sudo apt update &amp;&amp; sudo apt -y upgrade\n</code></pre>\n<h5 id=\"2.2-查看系统时间并修改时区\">2.2 查看系统时间并修改时区<a title=\"#2.2-查看系统时间并修改时区\" href=\"#2.2-查看系统时间并修改时区\"></a></h5>\n<pre><code>date -R\ntimedatectl set-timezone Asia/Shanghai\t\n# 若提示'Failed to create bus connection: No such file or directory'，先执行apt-get install dbus\n</code></pre>\n<p><img src=\"https://raw.githubusercontent.com/Nanzet/nanzet-imgs/master/images/2020062403.jpg\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<h5 id=\"2.3-安装upzip\">2.3 安装upzip<a title=\"#2.3-安装upzip\" href=\"#2.3-安装upzip\"></a></h5>\n<pre><code>sudo apt install unzip\n</code></pre>\n<h5 id=\"2.4-下载、安装官方维护脚本\">2.4 下载、安装官方维护脚本<a title=\"#2.4-下载、安装官方维护脚本\" href=\"#2.4-下载、安装官方维护脚本\"></a></h5>\n<pre><code>wget https://install.direct/go.sh &amp;&amp; sudo bash go.sh\n</code></pre>\n<img src=\"https://raw.githubusercontent.com/Nanzet/nanzet-imgs/master/images/2020063002.jpg\"/>\n<p> 上图的端口号和uuid是随机生成的，可在/etc/v2ray/config.json配置文件中进行更改。</p>\n<p> 生成正确格式的uuid可以参考： <a href=\"https://www.uuidgenerator.net/%EF%BC%8Clinux%E4%B9%9F%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4\" target=\"_blank\">https://www.uuidgenerator.net/，linux也可以使用命令</a> cat /proc/sys/kernel/random/uuid 生成。</p>\n<p><img src=\"https://raw.githubusercontent.com/Nanzet/nanzet-imgs/master/images/2020062801.jpg\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p> 查看 or 编辑/etc/v2ray/config.json：</p>\n<pre><code>cat or vim /etc/v2ray/config.json\n</code></pre>\n<h6 id=\"\"><img src=\"https://raw.githubusercontent.com/Nanzet/nanzet-imgs/master/images/2020062802.jpg\" alt=\"\"><a title=\"#\" href=\"#\"></a></h6>\n<h5 id=\"2.5-设置开机启动-&amp;-启动服务\">2.5 设置开机启动 &amp; 启动服务<a title=\"#2.5-设置开机启动-&amp;-启动服务\" href=\"#2.5-设置开机启动-&amp;-启动服务\"></a></h5>\n<pre><code>sudo systemctl enable v2ray &amp;&amp; sudo systemctl start/restart v2ray\n</code></pre>\n<p>注：systemctl start/restart/stop/status v2ray</p>\n<h5 id=\"2.6-设置防火墙：(ubuntu防火墙设置)\">2.6 设置防火墙：(<a href=\"https://www.jianshu.com/p/eccb913ac58d\">ubuntu防火墙设置</a>)<a title=\"#2.6-设置防火墙：(ubuntu防火墙设置)\" href=\"#2.6-设置防火墙：(ubuntu防火墙设置)\"></a></h5>\n<pre><code># 开启防火墙\nsudo ufw enable\n# 打开指定端口\nsudo ufw allow 15421/tcp\n\n# 注：要通过本机的xshell连接上远程的vps则需要开放vps的22端口\nsudo ufw allow 22\n\n# 若提示command not found，执行apt-get install ufw -y\n</code></pre>\n<h5 id=\"2.7-升级更新，重新执行安装，不会修改原配置\">2.7 升级更新，重新执行安装，不会修改原配置<a title=\"#2.7-升级更新，重新执行安装，不会修改原配置\" href=\"#2.7-升级更新，重新执行安装，不会修改原配置\"></a></h5>\n<pre><code>$ sudo bash go.sh\n</code></pre>\n<h5 id=\"2.8-解决高延迟问题\">2.8 解决高延迟问题<a title=\"#2.8-解决高延迟问题\" href=\"#2.8-解决高延迟问题\"></a></h5>\n<p>安装BBR：</p>\n<pre><code>wget -N --no-check-certificate &quot;https://raw.githubusercontent.com/chiakge/Linux-NetSpeed/master/tcp.sh&quot; &amp;&amp; chmod +x tcp.sh &amp;&amp; ./tcp.sh\n</code></pre>\n<p> 先选择安装BBR/BBR魔改版内核内核，安装完成后，在执行./tcp.sh按需要选择加速，我选择的是魔改版加速。</p>\n<p> 其他v2ray配置请参考官方教程有详细说明。</p>\n<h5 id=\"2.9-tls配置可能遇到的问题及解决方法总结\">2.9 <a href=\"https://guide.v2fly.org/advanced/tls.html\">TLS配置</a>可能遇到的问题及解决方法总结<a title=\"#2.9-tls配置可能遇到的问题及解决方法总结\" href=\"#2.9-tls配置可能遇到的问题及解决方法总结\"></a></h5>\n<p>（1）添加域名解析A记录参考：</p>\n<p><img src=\"https://raw.githubusercontent.com/Nanzet/nanzet-imgs/master/images/2020070405.jpg\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p>（2）解决使用’~/.acme.sh/acme.sh --issue -d <a href=\"http://mydomain.me\">mydomain.me</a> --standalone --keylength ec-256 --force’命令生成证书的80端口被占用问题：</p>\n<pre><code class=\"language-python\"># 查看80端口占用情况\nlsof -i:80\n\n# 若要关闭使用这个端口的程序，使用kill + 对应的pid\nkill -9 PID号\n</code></pre>\n<blockquote>\n<p>参考：</p>\n<p>a. <a href=\"https://guide.v2fly.org/\" target=\"_blank\">新 V2Ray 白话文指南</a></p>\n<p>b. <a href=\"https://yuan.ga/v2ray-complete-tutorial/\" target=\"_blank\">v2ray完全使用教程</a></p>\n<p>c. <a href=\"https://tophat.top/posts/98b102d8.html\" target=\"_blank\">caddy v2 安装教程</a>（WebSocket + TLS + Web尝试失败，有空再试，目前参照官方教程的tls配置成功，且速度较快）</p>\n</blockquote>\n<h4 id=\"三、客户端安装\">三、客户端安装<a title=\"#三、客户端安装\" href=\"#三、客户端安装\"></a></h4>\n<blockquote>\n<p>客户端如PC建议在chrome或firefox浏览器下载插件Proxy SwitchyOmega搭配使用。</p>\n</blockquote>\n<p><strong>客户端：</strong></p>\n<p><a href=\"https://github.com/v2ray/v2ray-core/releases\" target=\"_blank\"><strong>Windows</strong></a></p>\n<p><a href=\"https://github.com/2dust/v2rayN/releases\" target=\"_blank\"><strong>图形化客户端</strong></a></p>\n<p><a href=\"https://github.com/v2ray/v2ray-core/releases\" target=\"_blank\"><strong>MacOS</strong></a></p>\n<p><a href=\"https://github.com/v2ray/v2ray-core/releases\" target=\"_blank\"><strong>Linux</strong></a></p>\n<p><strong>Android:</strong></p>\n<p>V2RayNG: <a href=\"https://github.com/2dust/v2rayNG/releases\" target=\"_blank\">Github</a> or <a href=\"https://play.google.com/store/apps/details?id=com.v2ray.ang\" target=\"_blank\">Play Store</a></p>\n<p>BifrostV:   or <a href=\"https://play.google.com/store/apps/details?id=com.github.dawndiy.bifrostv\" target=\"_blank\">Play Store</a></p>\n<p><strong>iOS:（支持以下软件，链接可能过时，请在苹果商店下载）</strong></p>\n<p><a href=\"https://itunes.apple.com/tw/app/shadowrocket/id932747118\" target=\"_blank\">ShadowRocket</a></p>\n<p><a href=\"http://itunes.apple.com/tw/app/kitsunebi-proxy-utility/id1446584073\" target=\"_blank\">Kitsunebi - Proxy Utility</a></p>\n<p><a href=\"http://itunes.apple.com/tw/app/kitsunebi-lite/id1387913765\" target=\"_blank\">Kitsunebi Lite</a></p>\n<p><a href=\"https://itunes.apple.com/tw/app/pepi/id1283082051\" target=\"_blank\">Pepi</a></p>\n<p><a href=\"https://itunes.apple.com/tw/app/i2ray/id1445270056\" target=\"_blank\">i2Ray</a></p>\n<p><a href=\"https://itunes.apple.com/tw/app/quantumult/id1252015438\" target=\"_blank\">Quantumult</a></p>\n<p><strong>附：</strong></p>\n<p><a href=\"https://docs.qq.com/doc/DYlVOcWJtYlFPSFdN\" target=\"_blank\"><strong>400+苹果软件分享</strong></a></p>\n<p><strong>解决关于chrome浏览器插件离线安装和设置SwitchyOmega的问题：</strong>:smirk::smirk:</p>\n<p>（1）<a href=\"https://crxdl.com/\" target=\"_blank\">下载Chrome扩展插件Crx离线安装包</a>–搜索&quot;SwitchyOmega&quot;</p>\n<p>（2）<a href=\"https://www.cccitu.com/3391.html\" target=\"_blank\">谷歌Chrome浏览器安装扩展插件</a></p>\n<p>（3）SwitchyOmega配置<a href=\"https://www.cccitu.com/2655.html\" target=\"_blank\">Chrome浏览器SOCKS代理服务器设置教程</a></p>\n<p>（4）规则列表：（<a href=\"https://blog.csdn.net/qq_38879305/article/details/106619860\" target=\"_blank\">规则列表刷新不了</a>、仍然恢复不了：<a href=\"https://blog.csdn.net/qq_36561697/article/details/88350512?utm_medium=distribute.pc_relevant.none-task-blog-baidujs-1\" target=\"_blank\">戳我</a>）</p>\n<pre><code>https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt\n</code></pre>\n<p><img src=\"https://raw.githubusercontent.com/Nanzet/nanzet-imgs/master/images/2020062803.jpg\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p>（5）google！:laughing::laughing::laughing:en​joy it!</p>\n<p><img src=\"https://raw.githubusercontent.com/Nanzet/nanzet-imgs/master/images/2020062804.jpg\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n","prev":{"title":"Python 利用匿名函数和reduce()方法对嵌套列表去重","link":"2020/07/04/Python 利用匿名函数和reduce()方法对嵌套列表去重"},"next":{"title":"理解美团点评分布式ID生成系统--Leaf","link":"2020/06/11/了解美团点评分布式ID生成系统--Leaf"},"plink":"https://nanzet.cn/2020/07/04/V2Ray安装教程（初阶）/","reward":true,"copyright":{"author":"Nanzet","link":"<a href=\"https://nanzet.cn/2020/07/04/V2Ray安装教程（初阶）/\" title=\"V2Ray安装教程（初阶）\">https://nanzet.cn/2020/07/04/V2Ray安装教程（初阶）/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"},"reading_time":"1117 字约 7 分钟"}